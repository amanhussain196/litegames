<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Tower Stack | Man Games</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet"><style>:root{--bg-color:#2c3e50;--text-color:#ecf0f1;--accent:#e67e22}*{margin:0;padding:0;box-sizing:border-box;user-select:none}body{font-family:Nunito,sans-serif;background-color:var(--bg-color);color:var(--text-color);display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;overflow:hidden}h1{font-family:Fredoka,sans-serif;position:absolute;top:20px;font-size:3rem;color:var(--accent);text-shadow:2px 2px 0 #000;z-index:10}canvas{background:linear-gradient(to bottom,#34495e,#2c3e50);border:4px solid #fff;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.5);max-width:100%;max-height:80vh;outline:0}.score-display{position:absolute;top:100px;font-family:Fredoka,sans-serif;font-size:4rem;font-weight:700;text-shadow:2px 2px 0 #000;z-index:10;pointer-events:none}.controls-hint{margin-top:10px;font-size:1rem;opacity:.8}.back-btn{position:absolute;bottom:20px;color:#fff;text-decoration:none;font-weight:700;background:rgba(0,0,0,.5);padding:10px 20px;border-radius:20px;transition:all .2s}.back-btn:focus,.back-btn:hover{background:rgba(0,0,0,.8);transform:scale(1.05);outline:2px solid var(--accent)}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);z-index:100;display:flex;justify-content:center;align-items:center;backdrop-filter:blur(3px)}.modal{background:#fff;padding:40px;border-radius:30px;text-align:center;border:5px solid var(--accent);color:#2c3e50;animation:popIn .3s cubic-bezier(.175,.885,.32,1.275)}.modal h2{font-family:Fredoka,sans-serif;font-size:2.5rem;margin-bottom:10px}.modal p{font-size:1.5rem;margin-bottom:20px}button{padding:15px 30px;border-radius:15px;border:none;font-family:Fredoka,sans-serif;font-size:1.2rem;cursor:pointer;transition:transform .2s;background:var(--accent);color:#fff;font-weight:700;box-shadow:0 5px 0 #d35400}button:focus,button:hover{transform:translateY(-2px);box-shadow:0 7px 0 #d35400;outline:3px solid #2c3e50}button:active{transform:translateY(2px);box-shadow:0 3px 0 #d35400}@keyframes popIn{from{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}body.mode-tv{cursor:none}</style></head><body><h1>Tower Stack</h1><div class="score-display" id="scoreDisplay">0</div><canvas id="gameCanvas" width="400" height="600" tabindex="0"></canvas><div class="controls-hint">Press 5, Space, or Tap to Place Block</div><a href="index.html" class="back-btn">‚Üê Back to Menu</a><div class="modal-overlay" id="startModal"><div class="modal"><h2>Ready to Stack?</h2><button onclick="startGame()">Start Game</button></div></div><div class="modal-overlay" id="gameOverModal" style="display:none"><div class="modal"><h2>Game Over</h2><p>Height: <span id="finalScore">0</span></p><button onclick="resetGame()">Play Again</button></div></div><script>const urlParams=new URLSearchParams(window.location.search),mode=urlParams.get("mode");mode&&(document.body.classList.add("mode-"+mode),"tv"===mode&&(document.querySelector(".controls-hint").innerText="Press OK to Place Block"));const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d"),scoreDisplay=document.getElementById("scoreDisplay"),startModal=document.getElementById("startModal"),gameOverModal=document.getElementById("gameOverModal"),finalScoreSpan=document.getElementById("finalScore"),BLOCK_HEIGHT=30,INITIAL_WIDTH=200,INITIAL_SPEED=3;let animationId,blocks=[],currentBlock=null,score=0,speed=3,direction=1,gameState="start",cameraY=0;const COLORS=["#e74c3c","#e67e22","#f1c40f","#2ecc71","#3498db","#9b59b6"],SoundManager={ctx:null,init:function(){this.ctx||(this.ctx=new(window.AudioContext||window.webkitAudioContext))},playTone:function(e,t,c,n=.1){this.ctx||this.init(),"suspended"===this.ctx.state&&this.ctx.resume();const a=this.ctx.createOscillator(),o=this.ctx.createGain();a.type=t,a.frequency.setValueAtTime(e,this.ctx.currentTime),o.gain.setValueAtTime(n,this.ctx.currentTime),o.gain.exponentialRampToValueAtTime(.01,this.ctx.currentTime+c),a.connect(o),o.connect(this.ctx.destination),a.start(),a.stop(this.ctx.currentTime+c)},place:function(e){e?(this.playTone(600,"sine",.1,.2),setTimeout(()=>this.playTone(800,"sine",.2,.2),50)):this.playTone(400,"sine",.1,.1)},gameOver:function(){this.playTone(200,"sawtooth",.4,.2),setTimeout(()=>this.playTone(150,"sawtooth",.4,.2),200)}};function startGame(){SoundManager.init(),gameState="playing",startModal.style.display="none",gameOverModal.style.display="none",resetVars(),spawnBlock(),canvas.focus(),loop()}function resetGame(){startGame()}function resetVars(){blocks=[],blocks.push({x:(canvas.width-200)/2,y:canvas.height-50,width:200,height:30,color:COLORS[0]}),score=0,speed=3,scoreDisplay.textContent="0",cameraY=0}function spawnBlock(){const e=blocks[blocks.length-1],t=e.y-30;currentBlock={x:0,y:t,width:e.width,height:30,color:COLORS[blocks.length%COLORS.length]},direction=Math.random()>.5?1:-1,currentBlock.x=1===direction?-currentBlock.width:canvas.width}function placeBlock(){if("playing"!==gameState)return;const e=blocks[blocks.length-1];let t=currentBlock.width,c=currentBlock.x;const n=Math.max(c,e.x),a=Math.min(c+t,e.x+e.width)-n;if(a<=0)return void gameOver();let o=!1;Math.abs(c-e.x)<3?(c=e.x,t=e.width,o=!0):(t=a,c=n),blocks.push({x:c,y:currentBlock.y,width:t,height:30,color:currentBlock.color}),SoundManager.place(o),navigator.vibrate&&navigator.vibrate(40),score++,scoreDisplay.textContent=score,speed+=.1,spawnBlock()}function update(){currentBlock&&(currentBlock.x+=speed*direction,currentBlock.x+currentBlock.width>canvas.width&&(direction=-1),currentBlock.x<0&&(direction=1));const e=blocks[blocks.length-1].y;e<canvas.height/2&&(cameraY+=.1*(canvas.height/2-e-cameraY))}function draw(){ctx.fillStyle="#2c3e50",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.save(),ctx.translate(0,cameraY),blocks.forEach(e=>{ctx.fillStyle=e.color,ctx.fillRect(e.x,e.y,e.width,e.height),ctx.strokeStyle="rgba(0,0,0,0.2)",ctx.strokeRect(e.x,e.y,e.width,e.height),ctx.fillStyle="rgba(255,255,255,0.1)",ctx.fillRect(e.x,e.y,e.width,e.height/2)}),currentBlock&&(ctx.fillStyle=currentBlock.color,ctx.fillRect(currentBlock.x,currentBlock.y,currentBlock.width,currentBlock.height),ctx.fillStyle="rgba(255,255,255,0.1)",ctx.fillRect(currentBlock.x,currentBlock.y,currentBlock.width,currentBlock.height/2)),ctx.restore()}function loop(){"playing"===gameState&&(update(),draw(),animationId=requestAnimationFrame(loop))}function gameOver(){gameState="gameover",SoundManager.gameOver(),cancelAnimationFrame(animationId),finalScoreSpan.textContent=score,gameOverModal.style.display="flex",setTimeout(()=>{const e=gameOverModal.querySelector("button");e&&e.focus()},100)}function toggleFullscreen(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}document.addEventListener("keydown",e=>{const t=e.key,c=e.keyCode;let n=!1;if("Backspace"!==t&&"Escape"!==t&&8!==c&&27!==c&&461!==c&&10009!==c&&4!==c||(window.location.href="index.html",n=!0),["5"," ","Enter"].includes(t)||13===c||23===c){if("playing"===gameState)placeBlock();else{const e=document.activeElement;e&&"BUTTON"===e.tagName?e.click():"start"===gameState?startGame():"gameover"===gameState&&resetGame()}n=!0}"0"!==t&&"f"!==t.toLowerCase()||(toggleFullscreen(),n=!0),n&&(e.preventDefault(),e.stopPropagation())}),canvas.addEventListener("mousedown",e=>{e.preventDefault(),"playing"===gameState&&placeBlock()}),canvas.addEventListener("touchstart",e=>{e.preventDefault(),"playing"===gameState&&placeBlock()},{passive:!1}),resetVars(),draw(),window.onload=()=>{if("none"!==startModal.style.display){const e=startModal.querySelector("button");e&&e.focus()}else canvas.focus()},canvas.addEventListener("blur",()=>{"playing"===gameState&&setTimeout(()=>{document.activeElement&&document.activeElement!==document.body||canvas.focus()},200)})</script><script src="global.js"></script></body></html>