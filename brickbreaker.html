<!DOCTYPE html><html lang="en"><head><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><meta charset="UTF-8"><meta name="viewport" content="width=1280,initial-scale=1"><title>Brick Breaker | Man Games</title><link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet"><style>:root{--primary:#4ECDC4;--accent:#FF6B6B;--bg:#E0F7FA;--paddle:#2D3436;--ball:#FFD700;--text:#2D3436}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Fredoka,sans-serif;background-color:var(--bg);color:var(--text);display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;background-image:radial-gradient(#4ecdc4 1px,transparent 1px);background-size:30px 30px;overflow:hidden;touch-action:none}.game-container{position:relative;background:#fff;padding:5px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.1);border:5px solid #fff;outline:0}canvas{background:#2d3436;border-radius:10px;display:block;box-shadow:inset 0 0 20px rgba(0,0,0,.5);cursor:none}.ui-panel{display:flex;justify-content:space-between;width:100%;max-width:500px;margin-bottom:.2rem;padding:0 5px;align-items:center}.score-box{background:#fff;padding:4px 12px;border-radius:15px;font-size:.9rem;font-weight:700;box-shadow:0 5px 15px rgba(0,0,0,.05);display:flex;align-items:center;gap:5px}.btn{background:var(--accent);color:#fff;border:none;padding:10px 25px;border-radius:50px;font-family:inherit;font-weight:700;font-size:1rem;cursor:pointer;box-shadow:0 4px 0 #d64545;transition:all .1s}.btn:active{transform:translateY(4px);box-shadow:0 0 0 #d64545}.btn-secondary{background:var(--primary);box-shadow:0 4px 0 #3aa8a0}.btn-secondary:active{box-shadow:0 0 0 #3aa8a0}.btn-home{background:var(--primary);box-shadow:0 4px 0 #3aa8a0;margin-top:15px;text-decoration:none;display:inline-block;padding:8px 20px;border-radius:50px;color:#fff;font-weight:700;font-size:.9rem;cursor:pointer}.btn-home:active{box-shadow:0 0 0 #3aa8a0;transform:translateY(4px)}.coin-indicator{position:absolute;color:gold;font-weight:700;font-size:1.2rem;animation:floatUp 1s ease-out forwards;pointer-events:none}@keyframes floatUp{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-20px)}}.btn-pause{background:#f1c40f;color:#fff;border:none;padding:5px 15px;border-radius:15px;font-family:inherit;font-weight:700;font-size:.9rem;cursor:pointer;box-shadow:0 3px 0 #c0392b}.btn-pause:active{transform:translateY(3px);box-shadow:0 0 0 #c0392b}.overlay{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(255,255,255,.98);padding:2rem;border-radius:20px;text-align:center;box-shadow:0 20px 50px rgba(0,0,0,.2);min-width:320px;z-index:10}#startScreen{display:block}#gameOverModal{display:none}#levelCompleteModal{display:none}#pauseModal{display:none}h1{color:var(--accent);font-size:2.5rem;margin-bottom:.5rem}h2{color:var(--text);font-size:1.5rem;margin-bottom:1.5rem}.final-score{font-size:1.5rem;margin-bottom:1.5rem;color:var(--text)}.name-input{margin:10px 0;padding:10px;border-radius:10px;border:2px solid #ddd;font-family:inherit;font-size:1rem;width:80%;display:none}.button-group{display:flex;gap:10px;justify-content:center;margin-top:10px}.powerup-indicator{position:absolute;top:10px;left:50%;transform:translateX(-50%);background:rgba(255,255,255,.8);padding:5px 15px;border-radius:20px;font-weight:700;color:var(--text);display:none;pointer-events:none}#gameWrapper{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;width:100%;height:100vh;overflow-y:auto;scrollbar-width:none;padding-top:20px}#gameWrapper::-webkit-scrollbar{display:none}#gameWrapper:fullscreen{background:var(--bg);padding:10px}#gameWrapper:fullscreen .game-container{box-shadow:none;border:none;background:0 0;padding:0;max-height:55vh;display:flex;justify-content:center;align-items:center;width:100%}#gameWrapper:fullscreen canvas{max-height:100%;width:auto;max-width:100%}.btn-fullscreen{background:rgba(0,0,0,.1);color:var(--text);border:1px solid rgba(0,0,0,.1);padding:5px 15px;border-radius:15px;font-family:inherit;font-weight:700;font-size:.8rem;cursor:pointer;transition:all .2s}.btn-fullscreen:hover{background:rgba(0,0,0,.2)}#mobileControls{display:none;gap:20px;margin-top:20px;width:100%;justify-content:center;padding-bottom:20px}.mobile-btn{width:70px;height:70px;background:rgba(255,255,255,.5);border:2px solid rgba(0,0,0,.1);border-radius:50%;font-size:1.5rem;display:flex;justify-content:center;align-items:center;cursor:pointer;user-select:none;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.mobile-btn:active{background:rgba(255,255,255,.8);transform:scale(.95)}.mobile-btn.launch-btn{background:var(--accent);color:#fff;border:none;width:80px;height:80px;box-shadow:0 4px 0 #c0392b}.mobile-btn.launch-btn:active{box-shadow:0 0 0 #c0392b;transform:translateY(4px)}#gameWrapper:fullscreen #mobileControls,body.mode-mobile #mobileControls{display:flex}body.mode-tv{cursor:none}body.mode-tv .btn-fullscreen:focus,body.mode-tv .btn:focus{outline:5px solid var(--accent);transform:scale(1.1);z-index:100}</style></head><body><div id="gameWrapper"><a href="#" class="btn-home" onclick="goHome(event)" style="position:absolute;top:10px;left:10px;z-index:20">🏠 HOME</a><div class="ui-panel"><div class="score-box">LEVEL <span id="level">1</span></div><div class="score-box">🧱 <span id="score">0</span></div><div class="score-box">🏆 <span id="highScoreText">Player</span>: <span id="highScore">0</span></div><div class="score-box">❤️ <span id="lives">3</span></div><button class="btn-pause" onclick="togglePause()">⏸️</button> <button class="btn-fullscreen" onclick="toggleFullScreen()">⛶</button></div><div class="game-container" id="gameContainer" tabindex="0"><canvas id="gameCanvas" width="500" height="500"></canvas><div id="powerupText" class="powerup-indicator">POWER UP!</div><div id="startScreen" class="overlay"><svg width="80" height="80" viewBox="0 0 100 100" style="margin-bottom:15px"><rect x="10" y="10" width="80" height="30" rx="5" fill="#FF6B6B"/><rect x="10" y="50" width="25" height="20" rx="5" fill="#4ECDC4"/><rect x="40" y="50" width="25" height="20" rx="5" fill="#FFE66D"/><rect x="70" y="50" width="20" height="20" rx="5" fill="#FF6B6B"/><circle cx="50" cy="85" r="8" fill="#FFD700"/></svg><h1>BRICK BREAKER</h1><h2>Ready to Smash?</h2><button class="btn" onclick="startGame()">START GAME</button><p style="margin-top:15px;font-size:.9rem;color:#888">Mouse to Move • Click to Launch</p></div><div id="gameOverModal" class="overlay"><h1 id="gameOverTitle">GAME OVER!</h1><p class="final-score">Score: <span id="finalScore">0</span></p><input type="text" id="playerNameInput" class="name-input" placeholder="Enter your name" maxlength="10"><div class="button-group"><button class="btn" onclick="handleGameOverAction()">PLAY AGAIN</button> <button class="btn btn-secondary" onclick="showStartScreen()">MENU</button></div></div><div id="levelCompleteModal" class="overlay"><h1 style="color:#4ecdc4">LEVEL COMPLETE!</h1><p class="final-score">Get Ready for Level <span id="nextLevelNum">2</span></p><button class="btn" onclick="nextLevel()">NEXT LEVEL</button></div><div id="pauseModal" class="overlay"><h1>PAUSED</h1><div class="button-group"><button class="btn" onclick="togglePause()">RESUME</button></div></div></div></div><script>const SoundManager={ctx:new(window.AudioContext||window.webkitAudioContext),playTone(e,t,l,a=.1){"suspended"===this.ctx.state&&this.ctx.resume();const n=this.ctx.createOscillator(),i=this.ctx.createGain();n.type=t,n.frequency.setValueAtTime(e,this.ctx.currentTime),i.gain.setValueAtTime(a,this.ctx.currentTime),i.gain.exponentialRampToValueAtTime(.01,this.ctx.currentTime+l),n.connect(i),i.connect(this.ctx.destination),n.start(),n.stop(this.ctx.currentTime+l)},playHit(){this.playTone(300+200*Math.random(),"square",.05,.1)},playPaddle(){this.playTone(150,"triangle",.1,.15)},playPowerUp(){this.playTone(600,"sine",.1,.1),setTimeout(()=>this.playTone(800,"sine",.1,.1),100),setTimeout(()=>this.playTone(1200,"sine",.2,.1),200)},playDie(){this.playTone(200,"sawtooth",.3,.2),setTimeout(()=>this.playTone(100,"sawtooth",.4,.2),200)},playWin(){this.playTone(400,"sine",.2,.1),setTimeout(()=>this.playTone(600,"sine",.2,.1),200),setTimeout(()=>this.playTone(800,"sine",.4,.1),400)},playFireball(){this.playTone(100,"sawtooth",.1,.1),setTimeout(()=>this.playTone(80,"sawtooth",.2,.1),50)},playMetal(){this.playTone(800,"square",.05,.1),setTimeout(()=>this.playTone(1200,"square",.05,.05),20)},playCoin(){this.playTone(1e3,"sine",.1,.1),setTimeout(()=>this.playTone(1500,"sine",.2,.1),100)}},canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d"),scoreEl=document.getElementById("score"),livesEl=document.getElementById("lives"),levelEl=document.getElementById("level"),finalScoreEl=document.getElementById("finalScore"),modal=document.getElementById("gameOverModal"),levelModal=document.getElementById("levelCompleteModal"),pauseModal=document.getElementById("pauseModal"),nextLevelNumEl=document.getElementById("nextLevelNum"),startScreen=document.getElementById("startScreen"),gameOverTitle=document.getElementById("gameOverTitle"),nameInput=document.getElementById("playerNameInput"),powerupText=document.getElementById("powerupText"),highScoreEl=document.getElementById("highScore"),highScoreTextEl=document.getElementById("highScoreText");let gameLoop,score=0,highScore=0,highScoreName="Player",lives=3,level=1,isGameOver=!1,isPaused=!0,breakableBricksCount=0,levelsSinceLastGold=0;function loadHighScore(){highScore=localStorage.getItem("brickBreakerHighScore")||0,highScoreName=localStorage.getItem("brickBreakerHighScoreName")||"Player",highScoreEl.textContent=highScore,highScoreTextEl.textContent=highScoreName}function saveHighScore(e,t){e>highScore&&(highScore=e,highScoreName=t,localStorage.setItem("brickBreakerHighScore",highScore),localStorage.setItem("brickBreakerHighScoreName",highScoreName),highScoreEl.textContent=highScore,highScoreTextEl.textContent=highScoreName)}loadHighScore();const paddle={width:100,height:15,x:canvas.width/2-50,y:canvas.height-30,speed:8,color:"#2ecc71",isSticky:!1};let balls=[];const ballRadius=8,initialBallSpeed=6,brickRowCount=6,brickColumnCount=8,brickPadding=10,brickOffsetTop=60,brickOffsetLeft=35,brickWidth=(canvas.width-70-70)/8,brickHeight=20;let bricks=[],powerups=[],activePowerups=[],rightPressed=!1,leftPressed=!1,mouseX=0;function getLevelPattern(e){const t=[];if(t[1]=[[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],t[2]=[[1,0,1,0,1,0,1,0],[0,1,0,1,0,1,0,1],[1,0,1,0,1,0,1,0],[0,1,0,1,0,1,0,1],[1,0,1,0,1,0,1,0],[0,1,0,1,0,1,0,1]],t[3]=[[9,1,1,1,1,1,1,9],[9,2,2,2,2,2,2,9],[9,1,1,1,1,1,1,9],[9,0,0,0,0,0,0,9],[9,0,0,0,0,0,0,9],[9,9,0,0,0,0,9,9]],t[4]=[[0,0,0,3,3,0,0,0],[0,0,2,2,2,2,0,0],[0,1,1,1,1,1,1,0],[1,1,1,1,1,1,1,1],[9,0,0,0,0,0,0,9],[9,0,0,0,0,0,0,9]],t[e])return t[e];const l=6+Math.floor((e-5)/2),a=[];for(let t=0;t<l;t++){const t=[];for(let l=0;l<8;l++){const l=Math.random();l<.1?t.push(0):l<.2&&e>5?t.push(9):l<.4?t.push(3):l<.7?t.push(2):t.push(1)}a.push(t)}return a}function initBricks(e){bricks=[],breakableBricksCount=0;const t=getLevelPattern(e),l=t.length,a=t[0].length;for(let e=0;e<a;e++){bricks[e]=[];for(let a=0;a<l;a++){const l=t[a][e];if(0===l){bricks[e][a]={status:0};continue}let n=l,i=l,o=!1;9===l?(n=1/0,i=1/0,o=!0):breakableBricksCount++;let s=!o&&Math.random()<.15;bricks[e][a]={x:0,y:0,status:1,hp:n,maxHp:i,isMetal:o,maxHp:i,isMetal:o,isLucky:s,isGold:!1}}}const n=[];for(let e=0;e<a;e++)for(let t=0;t<l;t++)1!==bricks[e][t].status||bricks[e][t].isMetal||n.push(bricks[e][t]);if(n.length>0)if(Math.random()<.3||levelsSinceLastGold>=2){n[Math.floor(Math.random()*n.length)].isGold=!0,levelsSinceLastGold=0,console.log("Golden Brick Spawned!")}else levelsSinceLastGold++,console.log("No Gold Brick. Pity:",levelsSinceLastGold)}function getBrickColor(e){if(e.isGold)return"#FFD700";if(e.isMetal)return"#7f8c8d";const t=70-15*e.hp;return`hsl(180, 70%, ${Math.max(20,t)}%)`}function resetBall(){balls=[{x:canvas.width/2,y:canvas.height-40,dx:0,dy:0,stuck:!0,isFireball:!1}]}function startGame(){startScreen.style.display="none",modal.style.display="none",levelModal.style.display="none",pauseModal.style.display="none","suspended"===SoundManager.ctx.state&&SoundManager.ctx.resume(),score=0,score=0,lives=3,level=1,levelsSinceLastGold=0,scoreEl.textContent=score,livesEl.textContent=lives,levelEl.textContent=level,isGameOver=!1,isPaused=!1,loadHighScore(),paddle.width=100,initBricks(level),resetBall(),powerups=[],gameLoop&&cancelAnimationFrame(gameLoop),update()}function nextLevel(){level++,levelEl.textContent=level,levelModal.style.display="none",isPaused=!1,resetBall(),initBricks(level),powerups=[],update()}function showStartScreen(){modal.style.display="none",levelModal.style.display="none",pauseModal.style.display="none",startScreen.style.display="block",isPaused=!0}function togglePause(){isGameOver||"block"===startScreen.style.display||(isPaused=!isPaused,isPaused?pauseModal.style.display="block":(pauseModal.style.display="none",update()))}function handleGameOverAction(){if("none"!==nameInput.style.display){const e=nameInput.value.trim()||"Anonymous";saveHighScore(score,e)}startGame()}document.addEventListener("keydown",keyDownHandler,{passive:!1}),document.addEventListener("keyup",keyUpHandler,{passive:!1}),document.addEventListener("mousemove",mouseMoveHandler),document.addEventListener("click",mouseClickHandler);let dpadHoldInterval=null;function keyDownHandler(e){const t=e.key,l=e.keyCode;console.log("Key:",t,l);let a=!1;"Backspace"!==t&&"Escape"!==t&&8!==l&&27!==l&&461!==l&&10009!==l&&4!==l||(goHome(e),a=!0),["ArrowRight","Right","6"].includes(t)||39===l||22===l?(clearInterval(dpadHoldInterval),rightPressed=!0,dpadHoldInterval=setInterval(()=>{paddle.x<canvas.width-paddle.width&&(paddle.x+=7)},50),a=!0):["ArrowLeft","Left","4"].includes(t)||37===l||21===l?(clearInterval(dpadHoldInterval),leftPressed=!0,dpadHoldInterval=setInterval(()=>{paddle.x>0&&(paddle.x-=7)},50),a=!0):"0"===t?(toggleFullScreen(),a=!0):"Enter"!==t&&"Ok"!==t&&"Select"!==t&&" "!==t&&"5"!==t&&13!==l&&23!==l||("none"!==startScreen.style.display?startGame():"none"!==modal.style.display?handleGameOverAction():"none"!==levelModal.style.display?nextLevel():"none"!==pauseModal.style.display?togglePause():launchBall(),a=!0),a&&(e.preventDefault(),e.stopPropagation())}function keyUpHandler(e){const t=e.key,l=e.keyCode;["ArrowRight","Right","6"].includes(t)||39===l||22===l?(clearInterval(dpadHoldInterval),rightPressed=!1):(["ArrowLeft","Left","4"].includes(t)||37===l||21===l)&&(clearInterval(dpadHoldInterval),leftPressed=!1)}function mouseMoveHandler(e){const t=e.clientX-canvas.getBoundingClientRect().left;t>0&&t<canvas.width&&(mouseX=t,paddle.x=mouseX-paddle.width/2,paddle.x<0&&(paddle.x=0),paddle.x+paddle.width>canvas.width&&(paddle.x=canvas.width-paddle.width))}function mouseClickHandler(){launchBall()}function spawnPowerup(e,t,l=null){const a=["wide","fireball","plus3","multiply3"],n=l||a[Math.floor(Math.random()*a.length)];let i="#FFF",o="?";"coin"===n&&(i="#FFD700",o="$"),"wide"===n&&(i="#3498db",o="↔️"),"fireball"===n&&(i="#e74c3c",o="🔥"),"plus3"===n&&(i="#2ecc71",o="+3"),"multiply3"===n&&(i="#9b59b6",o="x3"),powerups.push({x:e,y:t,type:n,dy:3,color:i,symbol:o})}function activatePowerup(e){let t="";if("coin"===e?(SoundManager.playCoin(),"undefined"!=typeof GoldManager&&(GoldManager.addCoins(1),t="+1 GOLD")):SoundManager.playPowerUp(),"wide"===e)paddle.width=150,t="WIDE PADDLE",setTimeout(()=>paddle.width=100,1e4);else if("fireball"===e)balls.forEach(e=>e.isFireball=!0),t="FIREBALL!",setTimeout(()=>balls.forEach(e=>e.isFireball=!1),8e3);else if("plus3"===e){t="+3 BALLS";const e=balls[0]||{x:paddle.x,y:paddle.y-20,dx:0,dy:-5};for(let t=0;t<3;t++)balls.push({x:e.x,y:e.y,dx:8*(Math.random()-.5),dy:-Math.abs(e.dy||5),stuck:!1,isFireball:e.isFireball})}else if("multiply3"===e){t="TRIPLE BALLS!";const e=[];balls.forEach(t=>{for(let l=0;l<2;l++)e.push({x:t.x,y:t.y,dx:t.dx+2*(Math.random()-.5),dy:t.dy+2*(Math.random()-.5),stuck:!1,isFireball:t.isFireball})}),balls=balls.concat(e)}powerupText.textContent=t,powerupText.style.display="block",setTimeout(()=>powerupText.style.display="none",1500)}function collisionDetection(){for(let e=0;e<bricks.length;e++)for(let t=0;t<bricks[e].length;t++){let l=bricks[e][t];if(1===l.status){let a=e*(brickWidth+10)+35,n=30*t+60;l.x=a,l.y=n,balls.forEach(e=>{if(1===l.status&&e.x>a&&e.x<a+brickWidth&&e.y>n&&e.y<n+20){if(l.isMetal)return e.dy=-e.dy,void SoundManager.playMetal();l.isGold?(l.hp=0,l.status=0,breakableBricksCount--,score+=50,scoreEl.textContent=score,SoundManager.playCoin(),spawnPowerup(a+brickWidth/2,n+10,"coin")):(e.isFireball?(l.hp=0,SoundManager.playFireball()):(e.dy=-e.dy,l.hp--,SoundManager.playHit()),l.hp<=0&&(l.status=0,breakableBricksCount--,score+=10*level,scoreEl.textContent=score,l.isLucky&&spawnPowerup(a+brickWidth/2,n+10)))}})}}0!==breakableBricksCount||isPaused||(SoundManager.playWin(),isPaused=!0,nextLevelNumEl.textContent=level+1,levelModal.style.display="block")}function drawBall(){balls.forEach(e=>{ctx.beginPath(),ctx.arc(e.x,e.y,8,0,2*Math.PI),ctx.fillStyle=e.isFireball?"#FF4500":"#FFD700",ctx.fill(),e.isFireball&&(ctx.strokeStyle="#FFFF00",ctx.lineWidth=2,ctx.stroke()),ctx.closePath()})}function drawPaddle(){ctx.beginPath(),ctx.rect(paddle.x,paddle.y,paddle.width,paddle.height),ctx.fillStyle=paddle.color,ctx.fill(),ctx.closePath(),ctx.fillStyle="rgba(255,255,255,0.2)",ctx.fillRect(paddle.x,paddle.y,paddle.width,paddle.height/2)}function drawBricks(){for(let e=0;e<bricks.length;e++)for(let t=0;t<bricks[e].length;t++){let l=bricks[e][t];if(1===l.status){let a=e*(brickWidth+10)+35,n=30*t+60;ctx.beginPath(),ctx.rect(a,n,brickWidth,20),ctx.fillStyle=getBrickColor(l),ctx.fill(),ctx.closePath(),ctx.fillStyle="rgba(255,255,255,0.2)",ctx.fillRect(a,n,brickWidth,5),l.isMetal&&(ctx.strokeStyle="#95a5a6",ctx.lineWidth=2,ctx.strokeRect(a+2,n+2,brickWidth-4,16),ctx.fillStyle="#bdc3c7",ctx.beginPath(),ctx.arc(a+5,n+5,2,0,2*Math.PI),ctx.arc(a+brickWidth-5,n+5,2,0,2*Math.PI),ctx.arc(a+5,n+20-5,2,0,2*Math.PI),ctx.arc(a+brickWidth-5,n+20-5,2,0,2*Math.PI),ctx.fill()),l.isLucky&&(ctx.fillStyle="rgba(255, 255, 255, 0.8)",ctx.font="12px Arial",ctx.textAlign="center",ctx.fillText("?",a+brickWidth/2,n+10+4),Math.floor(Date.now()/200)%2==0&&(ctx.fillStyle="rgba(255, 255, 255, 0.4)",ctx.fillRect(a,n,brickWidth,20))),l.isGold&&(ctx.fillStyle="rgba(255, 255, 255, 0.3)",ctx.fillRect(a,n,brickWidth,5),ctx.fillRect(a,n,5,20))}}}function drawPowerups(){powerups.forEach(e=>{ctx.beginPath(),ctx.arc(e.x,e.y,12,0,2*Math.PI),ctx.fillStyle=e.color,ctx.fill(),ctx.fillStyle="#FFF",ctx.font="bold 10px Arial",ctx.textAlign="center",ctx.fillText(e.symbol,e.x,e.y+4),ctx.closePath()})}function update(){if(!isPaused){ctx.clearRect(0,0,canvas.width,canvas.height),drawBricks(),drawBall(),drawPaddle(),drawPowerups(),collisionDetection();for(let e=powerups.length-1;e>=0;e--){let t=powerups[e];t.y+=t.dy,t.y+12>=paddle.y&&t.y-12<=paddle.y+paddle.height&&t.x>=paddle.x&&t.x<=paddle.x+paddle.width?(activatePowerup(t.type),powerups.splice(e,1)):t.y>canvas.height&&powerups.splice(e,1)}for(let e=balls.length-1;e>=0;e--){let t=balls[e];if(t.stuck)t.x=paddle.x+paddle.width/2,t.y=paddle.y-8;else{if((t.x+t.dx>canvas.width-8||t.x+t.dx<8)&&(t.dx=-t.dx,SoundManager.playHit()),t.y+t.dy<8)t.dy=-t.dy,SoundManager.playHit();else if(t.y+t.dy>canvas.height-8-paddle.height)if(t.x>paddle.x&&t.x<paddle.x+paddle.width){t.dy=-t.dy;let e=t.x-(paddle.x+paddle.width/2);t.dx=.15*e,SoundManager.playPaddle()}else t.y+t.dy>canvas.height-8&&balls.splice(e,1);t.x+=t.dx,t.y+=t.dy}}0===balls.length&&(lives--,livesEl.textContent=lives,SoundManager.playDie(),lives<=0?(isGameOver=!0,finalScoreEl.textContent=score,modal.style.display="block",score>highScore?(gameOverTitle.textContent="NEW HIGH SCORE!",gameOverTitle.style.color="#FFD700",nameInput.style.display="block",nameInput.focus()):(gameOverTitle.textContent="GAME OVER!",gameOverTitle.style.color="#FF6B6B",nameInput.style.display="none"),"undefined"!=typeof TimeManager&&TimeManager.syncTimeRemote(!0)):resetBall()),rightPressed&&paddle.x<canvas.width-paddle.width?paddle.x+=7:leftPressed&&paddle.x>0&&(paddle.x-=7),isGameOver||(gameLoop=requestAnimationFrame(update))}}canvas.addEventListener("touchmove",e=>{e.preventDefault();const t=canvas.getBoundingClientRect();let l=e.touches[0].clientX-t.left;l*=canvas.width/t.width,l>0&&l<canvas.width&&(paddle.x=l-paddle.width/2)},{passive:!1}),canvas.addEventListener("touchstart",e=>{e.preventDefault(),launchBall()},{passive:!1});const urlParams=new URLSearchParams(window.location.search),mode=urlParams.get("mode");function isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function toggleFullScreen(){const e=document.getElementById("gameWrapper");document.fullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function launchBall(){if(isPaused&&"block"===!startScreen.style.display)return;let e=!1;balls.forEach(t=>{t.stuck&&(t.stuck=!1,t.dx=6*(Math.random()>.5?1:-1),t.dy=-6,e=!0)}),e&&SoundManager.playPaddle()}function handleMobileInput(e,t){"left"===e&&(leftPressed=t),"right"===e&&(rightPressed=t)}async function goHome(e){e&&e.preventDefault(),"undefined"!=typeof TimeManager&&await TimeManager.syncTimeRemote(!0),window.location.href="index.html"}"mobile"===mode||isTouchDevice()?document.body.classList.add("mode-mobile"):"tv"===mode&&document.body.classList.add("mode-tv"),window.onload=()=>{document.getElementById("gameContainer").focus()},document.getElementById("gameContainer").addEventListener("blur",()=>{setTimeout(()=>document.getElementById("gameContainer").focus(),50)})</script><script src="global.js?v=11"></script></body></html>